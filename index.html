<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><link rel="icon" href="data:">
<title>xr-cats</title></head><body>
<script type="importmap">
{
  "imports": {
    "three": "https://code4fukui.github.io/three.js/build/three.module.js",
    "three/addons/": "https://code4fukui.github.io/three.js/examples/jsm/",
    "three/nodes": "https://code4fukui.github.io/three.js/examples/jsm/nodes/Nodes.js"
  }
}
</script>
<main><h1>xr-cats</h1>
DATA: <a href=https://sketchfab.com/3d-models/bicolor-cat-e623a618ca344a8393d7ba4d63ec23cf>Bicolor Cat - Download Free 3D model by kenchoo (@kenchoo) [e623a61]</a> (<a href=https://creativecommons.org/licenses/by/4.0/>CC BY</a> by <a href=https://sketchfab.com/kenchoo>kenchoo</a>)<br>
DATA: <a href=https://sketchfab.com/3d-models/lion-61d687ca92dc4cafbd5e74e3be40d49d>Lion - Download Free 3D model by kenchoo (@kenchoo) [61d687c]</a> (<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA</a> by <a href=https://sketchfab.com/kenchoo>kenchoo</a>)<br>
</main>
<style>
main {
  position: fixed;
  top: 2em;
  left: 2em;
  background-color: rgba(0, 0, 0, .3);
  padding: 1em;
  color: white;
}
a {
  color: white !important;
}
</style>

<script type="module">
import { THREE, scene, camera, renderer } from "https://code4fukui.github.io/egxr.js/egxr.js";
import { loadGLTF } from "https://code4fukui.github.io/vr-beetle/loadGLTF.js";
import * as SkeletonUtils from "three/addons/utils/SkeletonUtils.js";
import { PCControl } from "https://code4fukui.github.io/vr-beetle/PCControl.js";

const pcctrl = new PCControl(camera, renderer.domElement);

const cloneAnimatedGLTF = (gltf) => {
  const model = gltf.scene;
  const m = SkeletonUtils.clone(model);
  m.mixer = new THREE.AnimationMixer(m);
  gltf.animations.forEach(clip => m.mixer.clipAction(clip).startAt(0).play());
  return m;
};

const models = [];

const y = -1.6;

const gltf1 = await loadGLTF("bicolor_cat.glb");
const m1 = cloneAnimatedGLTF(gltf1);
m1.position.set(0, y, -.8);
//m1.scale.set(.2, .2, .2);
models.push(m1);
scene.add(m1);

const gltf2 = await loadGLTF("lion.glb");
const m2 = cloneAnimatedGLTF(gltf2);
m2.position.set(0, y, 2);
m2.scale.set(.05, .05, .05);
m2.rotation.y = Math.PI - Math.PI / 2;
models.push(m2);
scene.add(m2);

/*
const gltf2 = await loadGLTF("lioness.glb");
const m2 = cloneAnimatedGLTF(gltf2);
m2.position.set(0, y, 2);
m2.scale.set(1, 1, 1);
m2.rotation.y = Math.PI;
models.push(m2);
scene.add(m2);
*/

const clock = new THREE.Clock();
renderer.setAnimationLoop(() => {
  const delta = clock.getDelta();
  models.forEach((m, idx) => m.mixer?.update(delta));
  pcctrl.update(delta);
	renderer.render(scene, camera);
});
</script>
</body></html>
